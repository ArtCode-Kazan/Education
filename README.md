# Тестовое web приложение FastApi c базой данных Postgresql
## 1. Общее описание
Данное приложение позволяет запустить web приложение FastApi и запущенную
в контейнере базу данных Postgresql.


## 2. Сервис БД
### Как запустить
Находясь в директории dbase-service, нужно выполнить команду:
```commandline
docker build -t image-name .
```
Для запуска контейнера используется следующая команда:
```commandline
docker run --name container-name -p host:local-port:container-port image-name
```
, где host - адрес хоста/POSTGRES_HOST,
local-port - используемый порт/POSTGRES_PORT,
container-port - порт внутри контейнера.

### Проверка запуска
В результате запуска будет создана база данных, содержащая одну таблицу
samples с полями id и name. Используя программу для управления БД
(например, DBeaver), создаем новое подкоючение с необходимыми параметрами.
Значения POSTGRES_USER, POSTGRES_PASSWORD, POSTGRES_DB нужно взять в
dockerfile, а POSTGRES_PORT и POSTGRES_HOST задаются при запуске контейнера.
Если запуск прошел успешно, должно создаться соединение, а в нем должна быть
таблица samples c полями id и name.

## 3. Сервис приложения
### Как запустить
В директории service необходимо создать файл с именем `.env`. В нем содержатся
переменные, необходимые для работы с сервисом. В нем так же используются
переменные POSTGRES_USER, POSTGRES_PASSWORD, POSTGRES_DB, POSTGRES_PORT и
POSTGRES_HOST, речь о которых шла в прошлом пункте.
Пример, как нужно заполнять .env файл:
```commandline
POSTGRES_DB=test-dbase
POSTGRES_USER=test-user
POSTGRES_PASSWORD=password
POSTGRES_PORT=7777
POSTGRES_HOST=127.0.0.1
```
Далее для установки сервиса необходим пакет Poetry для Python, который
устанавливается следующим образом:
```commandline
poetry install
```
Далее можно запускать сервис. Сервис запускается командой:
```commandline
python3.8 main.py
```

## Проверка запуска
Локально работу сервиса можно проверить в браузере по url:
http://localhost:3789/get - ручка `/get`, которая возвращает строку с текстом.
http://localhost:3789/post - ручка `/post` добавляет новую запись в таблицу
samples и возвращает сообщение об успешности добавления.
http://localhost:3789/get-all - ручка `/get-all` возвращает все записи из
таблицы samples в виде списка.

# 4. Задание
1. Клонировать репозиторий Education в свое удаленное хранилище репозиториев.
2. Выполнение задания должно идти в ветке с именем Docker-solving
3. Необходимо упаковать приложение в Docker файл. Предварительно нужно 
   развернуть приложение локально и проверить, что оно запускается.
   Docker файл должен находиться рядом с файлом `README.md`
4. При работе нужно обязательно сделать несколько коммитов (!)
5. После завершения работы нужно сделать пулл реквест на _@MikkoArtik_ 
   (ветка Docker-solving олжна сливаться в ветку Docker)
6. Ожидать ревью и выполнить правки
7. Создать `.dockerignore` файл для приложений на Python
8. Отправить работу на проверку
9. По окончании ревью создать образ и загрузить его в **_свое_** хранилище 
   образов на github
