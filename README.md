# Тестовое web приложение FastApi c базой данных Postgresql
## 1. Общее описание
Данное приложение позволяет запустить web приложение FastApi и запущенную
в контейнере базу данных Postgresql.

## 2. Сервис БД
### Как запустить
Находясь в директории dbase-service, нужно выполнить команду:
```commandline
docker build -t image-name .
```
Для запуска контейнера используется следующая команда:
```commandline
docker run --name container-name -p local-port:container-port image-name
```
где:
 - local-port - используемый порт/POSTGRES_PORT
 - container-port - порт внутри контейнера

### Проверка запуска
В результате запуска будет создана база данных, содержащая одну таблицу
samples с полями id и name.
Проверить подключение можно с помощью любого клиента (например, DBWeaver).

В собранной БД значения параметров следующие:
- пользователь: test-user
- пароль: Aspireone533
- имя БД: test-dbase
- хост: localhost (127.0.0.1)
Адрес порта взять тот, который был указан при старте докер коннтейнера.

Если запуск прошел успешно, должно создаться соединение, а в нем должна быть
таблица samples c полями id и name.

## 3. Сервис приложения

### Описание
API-сервис содержит две ручки, которые напрямую взаимодействуют с БД:
 - `/post` добавляет новую запись в таблицу samples и возвращает сообщение об успешности добавления.
 - `/get-all` возвращает все записи из таблицы samples в виде списка

### Как запустить
В директории service необходимо создать файл с именем `.env`. 

**Этот файл нужен только для локального запуска - при запуске через 
`docker-compose.yml` его быть не должно!**

В нем содержатся переменные, необходимые для работы с сервисом. 

Пример, как нужно заполнять .env файл:

```dotenv
POSTGRES_DB=test-dbase
POSTGRES_USER=test-user
POSTGRES_PASSWORD=password
POSTGRES_PORT=7777
POSTGRES_HOST=127.0.0.1
APP_HOST=0.0.0.0
APP_PORT=5478
```

Далее для установки сервиса необходимо установить зависимости с помощью 
Poetry:
```commandline
poetry install
```

Сервис запускается командой:
```commandline
python3.8 main.py
```

## Проверка запуска
Локально работу сервиса можно проверить в браузере по url:
- http://localhost:3789/get - ручка `/get`, которая возвращает строку с 
  текстом.

# 4. Задание
1. Клонировать репозиторий `Education` в свое удаленное хранилище репозиториев.
2. Выполнение задания должно идти в ветке с именем `DockerCompose-solving`
3. Необходимо упаковать приложение (cervice) в Docker файл. Предварительно 
   нужно развернуть приложение локально и проверить, что оно запускается.
   Docker файл должен находиться в папке `service`
4. **Основное задание**: собрать файл `docker-compose.yml`, который объединит 
   два сервиса - Postges и API-сервис и будет поднимать оба сервиса 
   одновременно.
5. При работе нужно обязательно сделать несколько коммитов (!)
6. После завершения работы нужно сделать пулл реквест на _@MikkoArtik_ 
   (ветка DockerCompose-solving должна сливаться в ветку DockerCompose)
7. Ожидать ревью и выполнить правки
8. Отправить работу на проверку
